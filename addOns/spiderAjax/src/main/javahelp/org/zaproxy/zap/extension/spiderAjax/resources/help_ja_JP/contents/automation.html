<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<TITLE>
Ajax スパイダー – 自動化フレームワーク対応
</TITLE>
</HEAD>
<BODY>
<H1>Ajax スパイダー – 自動化フレームワーク対応</H1>
このアドオンは自動化フレームワークに対応しています。

<H2>ジョブ: spiderAjax</H2>
spiderAjaxジョブにより、Ajaxスパイダーを実行できます。これは従来のスパイダーよりも低速ですが、最新のWebアプリケーションをうまく処理します。
<p>
この内容は、動画「<a href="https://youtu.be/WivoyVerBCo">ZAP Chat 10 Automation Framework Part 4 - Spidering</a>」で解説されています。
<p>
このジョブはモニターテストをサポートしています。

<pre>
  - type: spiderAjax                   # ajaxスパイダー - 従来のスパイダーよりも遅いが、最新のアプリをうまく処理する
    parameters:
      context:                         # 文字列: スパイダーを行うコンテキストの名前、デフォルト: 最初のコンテキスト
      user:                            # 文字列: 認証に使用するオプションのユーザー、環境変数で定義されている必要があります
      url:                             # 文字列: スパイダーを開始するURL、デフォルト: 最初のコンテキストのURL
      maxDuration:                     # Int: ajaxスパイダーが実行を許可される最大時間 (分)、デフォルト: 0 (無制限)
      maxCrawlDepth:                   # Int: クローラーが到達できる最大深度、デフォルト: 10、0は無制限
      numberOfBrowsers:                # Int: スパイダーが使用するブラウザの数。増やすと高速化されるが、より多くのメモリを使用する、デフォルト: CPUコア数
      runOnlyIfModern:                 # Boolean: trueの場合、"モダンなアプリ"のアラートが発生した場合にのみスパイダーが実行される、デフォルト: false
      inScopeOnly:                     # Boolean: trueの場合、スコープ外でリクエストされたURLはすべて無視される、デフォルト: true
      browserId:                       # 文字列: 使用するブラウザID、デフォルト: firefox-headless
      clickDefaultElems:               # Bool: 有効な場合、デフォルトの要素 'a'、'button'、'input' のみをクリックする、デフォルト: true
      clickElemsOnce:                  # Bool: 有効な場合、各要素を一度だけクリックする、デフォルト: true
      eventWait:                       # Int: クライアント側イベントが発生した後に待機する時間（ミリ秒）、デフォルト: 1000
      maxCrawlStates:                  # Int: クローラーがクロールすべき最大クロールステート数、デフォルト: 0 (無制限)
      randomInputs:                    # Bool: 有効な場合、input 要素にランダムな値が入力される、デフォルト: true
      reloadWait:                      # Int: URLがロードされた後に待機する時間 (ミリ秒)、デフォルト: 1000
      scopeCheck:                      # 文字列: スコープチェック、Flexible または Strict、デフォルト: Strict
      elements:                        # クリックするHTML要素のリスト - clickDefaultElems が false でない限り適用されません
      - "a"
      - "button"
      - "input"
      excludedElements:                 # クリックから除外するHTML要素のリスト
        - description: "Logout Button"  # 文字列: 除外の説明
          element: "button"             # 文字列: 要素の名前
          xpath:                        # 文字列: 要素のXPath、オプション
          text:                         # 文字列: 要素のテキスト (完全一致、大文字と小文字を区別)、オプション
          attributeName: "aria-label"   # 文字列: 属性の名前、値が提供されていない限りオプション
          attributeValue: "Logout"      # 文字列: 属性の値、名前が提供されていない限りオプション
      
    tests:
      - name: 'At least 100 URLs found'      # 文字列: テストの名前、デフォルト: statistic + operator + value
        type: 'stats'                        # 文字列: テストのタイプ、現時点では 'stats' のみサポートされています
        statistic: 'spiderAjax.urls.added'   # 文字列: Integer型またはLong型の統計の名前、現在サポートされているもの: 'spiderAjax.urls.added'
        operator: '>='                       # 文字列 ['==', '!=', '>=', '>', '<', '<=']: Operator used for testing
        value: 100                           # Int: Change this to the number of URLs you expect to find
        onFail: 'info'                       # String [warn, error, info]: Change this to 'warn' or 'error' for the test to take effect
</pre>

runOnlyIfModern が True に設定されている場合、<a href="https://www.zaproxy.org/docs/desktop/addons/automation-framework/job-pscanwait/">passiveScan-wait</a>ジョブをこのジョブの前 (および後) に実行する必要があり、また<a href="https://www.zaproxy.org/docs/alerts/10109/">モダンWebアプリケーション</a>ルールがインストールされ、有効になっている必要があります。 これらのいずれかが行われていない場合、Ajaxスパイダーは常に実行され、警告が出力されます。
両方が行われており、"モダンWebアプリケーション"のアラートが発生しない場合、これは従来のアプリケーションであり、Ajaxスパイダーは不要であると判断されます。
</BODY>
</HTML>